{# app/templates/recipe_detail_page.html #}
{% extends "base.html" %}

{% block title %}{{ recipe.title | e }} — What2Cook{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-10">
    <div class="card mb-4">
      <div class="row g-0">
        <div class="col-md-5">
          <img src="{{ recipe.image_url or (recipe.image_meta.file_url if recipe.image_meta else request.url_for('static', path='img/placeholder.png')) }}"
               alt="{{ recipe.title|e }}"
               class="img-fluid w-100"
               style="object-fit:cover; max-height:420px;">
          {% if recipe.image_meta %}
            <div class="small text-muted mt-2">
              {% if recipe.image_meta.author %}Photo: {{ recipe.image_meta.author|e }}{% endif %}
              {% if recipe.image_meta.license_url %} — <a href="{{ recipe.image_meta.license_url }}" target="_blank">license</a>{% endif %}
              {% if recipe.image_meta.page_url %} — <a href="{{ recipe.image_meta.page_url }}" target="_blank">source</a>{% endif %}
            </div>
          {% endif %}
        </div>

        <div class="col-md-7">
          <div class="card-body">
            <h2 class="card-title">{{ recipe.title | e }}</h2>
            <p class="text-muted mb-2">
              <strong>Prep:</strong> {{ recipe.prep_minutes or '—' }} min &nbsp; • &nbsp;
              <strong>Serves:</strong> {{ recipe.servings or '—' }}
            </p>

            <h5>Ingredients</h5>
            <ul>
              {% for ing in recipe.ingredients %}
                <li>{{ ing | e }}</li>
              {% endfor %}
            </ul>

            <h5>Instructions</h5>
            <p style="white-space:pre-line;">{{ recipe.instructions or '-' }}</p>

            <div class="mt-3">
              <a href="{{ request.url_for('search') }}" class="btn btn-outline-secondary btn-sm">Back to search</a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
{% endblock %}
