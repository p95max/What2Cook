{% extends "base.html" %}

{% block title %}Search â€” What2Cook{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Available ingredients</h5>
        <p class="card-text">Click an ingredient to see recipes that contain it. You can click multiple ingredients (they will be appended to the query string).</p>

        <div id="ingredients-list" class="mb-3 d-flex flex-wrap gap-2">
          {% if ingredients is defined and ingredients %}
            {% for ing in ingredients %}
              <a href="/recipes/search_simple?ingredient={{ ing|urlencode }}" class="btn btn-outline-secondary btn-sm" role="button" title="Search recipes with {{ ing }}">
                {{ ing }}
              </a>
            {% endfor %}
          {% else %}
            <div class="text-muted">No ingredients found in database.</div>
          {% endif %}
        </div>

      </div>
    </div>

    <div id="results" class="row g-3">
      {% set has_query = request.query_params.get('ingredient','')|length > 0 %}
      {% if not has_query %}
        <div class="col-12">
          <div class="alert alert-info">
            No search performed yet. Click an ingredient above to start searching. See <a href="/docs">API docs</a> for programmatic access.
          </div>
        </div>

      {% elif recipes is defined and recipes|length == 0 %}
        <div class="col-12">
          <div class="alert alert-warning">No recipes found for the selected ingredient(s).</div>
        </div>

      {% else %}
        {% import "includes/receipt_detail.html" as receipt %}
        {% for r in recipes %}
          {{ receipt.recipe_card(r) }}
          {{ receipt.recipe_detail(r) }}
        {% endfor %}
      {% endif %}
    </div>

  </div>
</div>
{% endblock %}
