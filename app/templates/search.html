{% extends "base.html" %}

{% block title %}Search â€” What2Cook{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Enter ingredients you have</h5>
        <p class="card-text">Separate ingredients by comma or newline. Example: <code>egg, milk, flour</code></p>

        <div id="alerts"></div>

        <form id="search-form" class="mb-3" method="get" action="/search">
          <div class="mb-2">
            <textarea id="ingredients-input" name="ingredients" class="form-control" rows="3" placeholder="e.g. egg, milk, flour">{{ request.query_params.get('ingredients','') }}</textarea>
          </div>
          <div class="d-flex gap-2">
            <button id="search-btn" type="submit" class="btn btn-primary">Search</button>
            <button id="clear-btn" type="button" class="btn btn-outline-secondary">Clear</button>
            <div id="spinner" class="spinner-border text-primary ms-auto" role="status" style="display:none"><span class="visually-hidden">Loading...</span></div>
          </div>
        </form>

      </div>
    </div>

    <div id="results" class="row g-3">
    {% set has_query = request.query_params.get('ingredients','')|length > 0 %}
    {% if not has_query %}
      <div class="col-12"><div class="alert alert-info">No search performed yet. Use the form above or open <a href="/docs">API docs</a>.</div></div>
    {% elif recipes is defined and recipes|length == 0 %}
      <div class="col-12"><div class="alert alert-warning">No recipes found for your ingredients.</div></div>

      {% else %}
        {% import "includes/receipt_detail.html" as receipt %}
        {% for r in recipes %}
          {{ receipt.recipe_card(r) }}
          {{ receipt.recipe_detail(r) }}
        {% endfor %}
      {% endif %}
    </div>

  </div>
</div>
{% endblock %}
